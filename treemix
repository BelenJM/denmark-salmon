# Treemix 

# First, plink file has been created using the 5e6 vcf file:
plink --noweb --const-fid 0 --vcf ../gatk4_merge_vcf/5e6.gatk4_laks_onTarget_prune800 --allow-extra-chr --recode --out 5e6.plink
# Create dat file: same two columns as fam file and third column with cluster id
plink --file 5e6.plink --double-id --allow-extra-chr --chr-set 29 --make-just-fam

# Estimate allele freq using:
plink --file 5e6.plink --missing --freq --double-id --allow-extra-chr --chr-set 29 --within 5e6.dat --out 5e6.plink2

# Following manual here
gzip 5e6.plink2.frq.strat
# Manual Python conversion script
python plink2treemix.py 5e6.plink2.frq.strat.gz 5e6.treemix.frq.gz

# visualization of the tree and residuals to see how the model fits the data
R
source("src/plotting funcs.R")
plot_tree("out_stem")
plot_resid("out_stem", "pop_order") # create pop_order file: one line per pop name, for visualization purposes

